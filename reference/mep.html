<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Scatterplot of marginal effects based on fitted model objects."><title>Marginal Effect Plots — mep • ResourceSelection</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Marginal Effect Plots — mep"><meta property="og:description" content="Scatterplot of marginal effects based on fitted model objects."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script src="https://cdn.usefathom.com/script.js" data-site="KTMJHUPR" defer></script><link rel="icon" href="https://peter.solymos.org/favicon.ico"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ResourceSelection</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3-6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://www.linkedin.com/in/peter-solymos/" aria-label="Linkedin">
    <span class="fa fa-linkedin"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/psolymos" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="http://github.com/psolymos" aria-label="GitHub">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Marginal Effect Plots</h1>
      
      <div class="d-none name"><code>mep.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Scatterplot of marginal effects based on fitted model objects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mep</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">mep</span><span class="op">(</span><span class="va">object</span>, which<span class="op">=</span><span class="cn">NULL</span>, link<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>    level<span class="op">=</span><span class="fl">0.95</span>, unique<span class="op">=</span><span class="fl">10</span>, n<span class="op">=</span><span class="fl">25</span>, minbucket<span class="op">=</span><span class="fl">5</span>, digits<span class="op">=</span><span class="fl">4</span>,</span>
<span>    <span class="va">col.points</span>, col.lines<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">19</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="va">ask</span>, subset<span class="op">=</span><span class="cn">NULL</span>, <span class="va">ylab</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>a fitted model object.</p></dd>

  <dt>which</dt>
<dd><p>numeric, logical, or character. Indices for the variables in the model frame
if only one or a subset is desired.</p></dd>

  <dt>link</dt>
<dd><p>character accepted by <code><a href="https://rdrr.io/r/stats/make.link.html" class="external-link">make.link</a></code>,
optional argument to determine scaling.
It is guessed when value cannot be determined based on
<code>family(object)$link</code> (see Details).</p></dd>

  <dt>level</dt>
<dd><p>numeric [0, 1], the confidence level required.</p></dd>

  <dt>unique, digits</dt>
<dd><p>numeric, the number of unique points above which bins are used.
If the number of unique values is less than or equal to this number,
unique values are used without binning. Unique values are subject to
rounding to <code>digits</code>.</p></dd>

  <dt>n, minbucket</dt>
<dd><p>number of bins (<code>n</code>) to be used in quantile estimation when variable is
not treated as unique points. <code>minbucket</code> is the minimum number of points
within each bin. <code>n</code> is decreased until <code>minbucket</code> condition is
satisfied.</p></dd>

  <dt>col.points, pch</dt>
<dd><p>color and type of points to be plotted.</p></dd>

  <dt>col.lines, lty, lwd</dt>
<dd><p>color, type, and width of quantile lines to be plotted.
The 1st value correspond to the median, the 2nd value to the upper and lower
quantiles, respectively.</p></dd>

  <dt>ask</dt>
<dd><p>logical. If <code>TRUE</code>, the user is asked before each plot,
see <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a>(ask=.)</code>.</p></dd>

  <dt>subset</dt>
<dd><p>an optional vector specifying a subset of the data to be used for plotting.</p></dd>

  <dt>ylab</dt>
<dd><p>character or expression, optional y axis label.</p></dd>

  <dt>...</dt>
<dd><p>other possible arguments passed to graphical functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The input object must have a <code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></code> and <code><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame</a></code>
method, and possibly a well identifiable family/link component
(<code>family(object)$link</code>).
In the absence of family/link information, the range of the fitted
value will be used to guess the scaling (identity, log, or logit)
unless directly supplied via the <code>link</code> argument.</p>
<p>Fitted values (f(x) = f(x_1,...,x_i,...,x_p); i = 1,...,p) are plotted against x_i.
The visual display is determined by the type of x_i (un-ordered factor, ordered
factor, unique numeric values, binned numeric values).
For each unique vale or bin, the median and confidence intervals
(quantiles corresponding to <code>level</code>) of f(x) are calculated.
Binned values are smoothed by <code><a href="https://rdrr.io/r/stats/lowess.html" class="external-link">lowess</a></code> unless <code>n</code> &lt; 3.</p>
<p>Jitter is added to factor and unique value types.
Jitter is calculated based on kernel <code><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></code>.</p>
<p>The model frame includes the response variable as well. Plotting f(x)
as a function of the observations might be a useful visualization too
to indicate goodness of fit or the lack of it.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The produces one or several marginal plots as a side effect.
Returns a list of quantiles of fitted values
corresponding to binned/unique values of variables in the input object.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Avgar, T., Lele, S. R., Keim, J. L. &amp; Boyce, M. S. (2017)
Relative Selection Strength:
Quantifying effect size in habitat- and step-selection inference.
Ecology and Evolution 7, 5322--5330.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Peter Solymos and Subhash Lele</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="kdepairs.html">kdepairs</a></code> for 2D kernel density estimates and contours.</p>
<p><code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></code> for fitted values and
<code><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame</a></code> for model frames.</p>
<p><code><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></code> and <code><a href="https://rdrr.io/r/stats/lowess.html" class="external-link">lowess</a></code> for smoothing.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">goats</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">goats</span><span class="op">$</span><span class="va">ELEVATION</span> <span class="op">&lt;-</span> <span class="va">goats</span><span class="op">$</span><span class="va">ELEVATION</span><span class="op">/</span><span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">goats</span><span class="op">$</span><span class="va">TASPc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">goats</span><span class="op">$</span><span class="va">TASP</span>, <span class="fl">3</span>, ordered_result<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">goats</span><span class="op">$</span><span class="va">SLOPEc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">goats</span><span class="op">$</span><span class="va">SLOPE</span>, <span class="fl">3</span>, ordered_result<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="rsf.html">rspf</a></span><span class="op">(</span><span class="va">STATUS</span> <span class="op">~</span> <span class="va">TASPc</span> <span class="op">+</span> <span class="va">SLOPEc</span> <span class="op">+</span> <span class="va">ELEVATION</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">ELEVATION</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="va">goats</span>, m<span class="op">=</span><span class="fl">0</span>, B<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">mep</span><span class="op">(</span><span class="va">fit</span>, which<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="co">#, subset=sample.int(nrow(goats), 10^4))</span></span></span>
<span class="r-plt img"><img src="mep-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Subhash R. Lele, Jonah L. Keim, Peter Solymos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

