<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Marginal Effect Plots — mep • ResourceSelection</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Marginal Effect Plots — mep" />
<meta property="og:description" content="Scatterplot of marginal effects based on fitted model objects." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-55877016-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-55877016-2');
</script>


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ResourceSelection</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/psolymos/ResourceSelection">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Marginal Effect Plots</h1>
    
    <div class="hidden name"><code>mep.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Scatterplot of marginal effects based on fitted model objects.</p>
    </div>

    <pre class="usage"><span class='fu'>mep</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>mep</span>(<span class='no'>object</span>, <span class='kw'>which</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>link</span><span class='kw'>=</span><span class='kw'>NULL</span>,
    <span class='kw'>level</span><span class='kw'>=</span><span class='fl'>0.95</span>, <span class='kw'>unique</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>n</span><span class='kw'>=</span><span class='fl'>25</span>, <span class='kw'>minbucket</span><span class='kw'>=</span><span class='fl'>5</span>, <span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>4</span>,
    <span class='no'>col.points</span>, <span class='kw'>col.lines</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>2</span>), <span class='kw'>pch</span><span class='kw'>=</span><span class='fl'>19</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>), <span class='kw'>lwd</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>2</span>),
    <span class='no'>ask</span>, <span class='kw'>subset</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>ylab</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>a fitted model object.</p></td>
    </tr>
    <tr>
      <th>which</th>
      <td><p>numeric, logical, or character. Indices for the variables in the model frame
if only one or a subset is desired.</p></td>
    </tr>
    <tr>
      <th>link</th>
      <td><p>character accepted by <code><a href='https://rdrr.io/r/stats/make.link.html'>make.link</a></code>,
optional argument to determine scaling.
It is guessed when value cannot be determined based on
<code>family(object)$link</code> (see Details).</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>numeric [0, 1], the confidence level required.</p></td>
    </tr>
    <tr>
      <th>unique, digits</th>
      <td><p>numeric, the number of unique points above which bins are used.
If the number of unique values is less than or equal to this number,
unique values are used without binning. Unique values are subject to
rounding to <code>digits</code>.</p></td>
    </tr>
    <tr>
      <th>n, minbucket</th>
      <td><p>number of bins (<code>n</code>) to be used in quantile estimation when variable is
not treated as unique points. <code>minbucket</code> is the minimum number of points
within each bin. <code>n</code> is decreased until <code>minbucket</code> condition is
satisfied.</p></td>
    </tr>
    <tr>
      <th>col.points, pch</th>
      <td><p>color and type of points to be plotted.</p></td>
    </tr>
    <tr>
      <th>col.lines, lty, lwd</th>
      <td><p>color, type, and width of quantile lines to be plotted.
The 1st value correspond to the median, the 2nd value to the upper and lower
quantiles, respectively.</p></td>
    </tr>
    <tr>
      <th>ask</th>
      <td><p>logical. If <code>TRUE</code>, the user is asked before each plot,
see <code><a href='https://rdrr.io/r/graphics/par.html'>par</a>(ask=.)</code>.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>an optional vector specifying a subset of the data to be used for plotting.</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p>character or expression, optional y axis label.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other possible arguments passed to graphical functions.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The input object must have a <code><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></code> and <code><a href='https://rdrr.io/r/stats/model.frame.html'>model.frame</a></code>
method, and possibly a well identifiable family/link component
(<code>family(object)$link</code>).
In the absence of family/link information, the range of the fitted
value will be used to guess the scaling (identity, log, or logit)
unless directly supplied via the <code>link</code> argument.</p>
<p>Fitted values (f(x) = f(x_1,...,x_i,...,x_p); i = 1,...,p) are plotted against x_i.
The visual display is determined by the type of x_i (un-ordered factor, ordered
factor, unique numeric values, binned numeric values).
For each unique vale or bin, the median and confidence intervals
(quantiles corresponding to <code>level</code>) of f(x) are calculated.
Binned values are smoothed by <code><a href='https://rdrr.io/r/stats/lowess.html'>lowess</a></code> unless <code>n</code> &lt; 3.</p>
<p>Jitter is added to factor and unique value types.
Jitter is calculated based on kernel <code><a href='https://rdrr.io/r/stats/density.html'>density</a></code>.</p>
<p>The model frame includes the response variable as well. Plotting f(x)
as a function of the observations might be a useful visualization too
to indicate goodness of fit or the lack of it.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The produces one or several marginal plots as a side effect.
Returns a list of quantiles of fitted values
corresponding to binned/unique values of variables in the input object.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Avgar, T., Lele, S. R., Keim, J. L. &amp; Boyce, M. S. (2017)
Relative Selection Strength:
Quantifying effect size in habitat- and step-selection inference.
Ecology and Evolution 7, 5322--5330.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='kdepairs.html'>kdepairs</a></code> for 2D kernel density estimates and contours.</p>
<p><code><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></code> for fitted values and
<code><a href='https://rdrr.io/r/stats/model.frame.html'>model.frame</a></code> for model frames.</p>
<p><code><a href='https://rdrr.io/r/stats/density.html'>density</a></code> and <code><a href='https://rdrr.io/r/stats/lowess.html'>lowess</a></code> for smoothing.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>goats</span>)
<span class='no'>goats</span>$<span class='no'>ELEVATION</span> <span class='kw'>&lt;-</span> <span class='no'>goats</span>$<span class='no'>ELEVATION</span>/<span class='fl'>1000</span>
<span class='no'>goats</span>$<span class='no'>TASPc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span>(<span class='no'>goats</span>$<span class='no'>TASP</span>, <span class='fl'>3</span>, <span class='kw'>ordered_result</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='no'>goats</span>$<span class='no'>SLOPEc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span>(<span class='no'>goats</span>$<span class='no'>SLOPE</span>, <span class='fl'>3</span>, <span class='kw'>ordered_result</span><span class='kw'>=</span><span class='fl'>TRUE</span>)

<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rsf.html'>rspf</a></span>(<span class='no'>STATUS</span> ~ <span class='no'>TASPc</span> + <span class='no'>SLOPEc</span> + <span class='no'>ELEVATION</span> + <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='no'>ELEVATION</span>^<span class='fl'>2</span>), <span class='no'>goats</span>, <span class='kw'>m</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>B</span><span class='kw'>=</span><span class='fl'>0</span>)

<span class='no'>op</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='fu'>mep</span>(<span class='no'>fit</span>, <span class='kw'>which</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>4</span>)<span class='co'>#, subset=sample.int(nrow(goats), 10^4))</span></div><div class='img'><img src='mep-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='no'>op</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Peter Solymos and Subhash Lele</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Subhash R. Lele, Jonah L. Keim, Peter Solymos.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


